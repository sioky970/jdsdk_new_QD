# ç™»å½•å­—æ®µåä¸åŒ¹é…é—®é¢˜ä¿®å¤

## âŒ é—®é¢˜æè¿°

**401 Unauthorized é”™è¯¯çš„çœŸæ­£åŸå› **ï¼šå‰åç«¯å­—æ®µåä¸ä¸€è‡´

### å‰ç«¯å‘é€çš„æ•°æ®
```json
{
  "userName": "admin",    // âŒ é©¼å³°å‘½åï¼ˆcamelCaseï¼‰
  "password": "admin123"
}
```

### åç«¯æœŸæœ›çš„æ•°æ®
```json
{
  "username": "admin",    // âœ… å…¨å°å†™
  "password": "admin123"
}
```

## ğŸ” é—®é¢˜æ ¹æº

1. **å‰ç«¯ç™»å½•ç»„ä»¶**ï¼ˆ`pwd-login.vue`ï¼‰ä½¿ç”¨ `userName` å­—æ®µï¼š
   ```typescript
   const model: FormModel = reactive({
     userName: 'Soybean',  // âŒ é©¼å³°å‘½å
     password: '123456'
   });
   ```

2. **åç«¯ Go æ¨¡å‹**æœŸæœ› `username` å­—æ®µï¼š
   ```go
   type LoginRequest struct {
       Username string `json:"username" binding:"required"`  // âœ… å…¨å°å†™
       Password string `json:"password" binding:"required"`
   }
   ```

3. **åŸç™»å½•API**ç›´æ¥ä¼ é€’å­—æ®µï¼Œå¯¼è‡´ä¸åŒ¹é…ï¼š
   ```typescript
   // auth.ts - ä¿®å¤å‰
   export function fetchLogin(username: string, password: string) {
     return request({
       data: {
         username,  // âŒ å‚æ•°åæ˜¯usernameï¼Œä½†å‰ç«¯ä¼ å…¥çš„æ˜¯userName
         password
       }
     });
   }
   ```

## âœ… ä¿®å¤æ–¹æ¡ˆ

åœ¨ `src/service/api/auth.ts` ä¸­æ·»åŠ å­—æ®µåè½¬æ¢ï¼š

```typescript
// auth.ts - ä¿®å¤å
export function fetchLogin(userName: string, password: string) {
  return request<Api.Auth.LoginToken>({
    url: '/api/auth/login',
    method: 'post',
    data: {
      username: userName,  // âœ… å°† userName è½¬æ¢ä¸º username
      password
    }
  });
}
```

**å…³é”®æ”¹åŠ¨**ï¼š
- å‚æ•°åæ”¹ä¸º `userName`ï¼ˆåŒ¹é…å‰ç«¯ç»„ä»¶ï¼‰
- åœ¨è¯·æ±‚æ•°æ®ä¸­æ˜¾å¼æ˜ å°„ï¼š`username: userName`ï¼ˆåŒ¹é…åç«¯æœŸæœ›ï¼‰

## ğŸ“Š æ•°æ®æµè½¬

```
å‰ç«¯ç»„ä»¶ (pwd-login.vue)
  â†“
model.userName = "admin"
  â†“
authStore.login(model.userName, model.password)
  â†“
fetchLogin(userName, password)
  â†“
è¯·æ±‚æ•°æ®: { username: userName, password }
  â†“
å‘é€åˆ°åç«¯: { "username": "admin", "password": "admin123" }
  â†“
Go åç«¯è§£ææˆåŠŸ âœ…
```

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
æ‰“å¼€ DevTools â†’ Network â†’ æŸ¥çœ‹ç™»å½•è¯·æ±‚ï¼š

**Request Payload åº”è¯¥æ˜¾ç¤º**ï¼š
```json
{
  "username": "admin",     // âœ… æ³¨æ„æ˜¯ usernameï¼Œä¸æ˜¯ userName
  "password": "admin123"
}
```

### 2. æµ‹è¯•ç™»å½•
1. è®¿é—® http://localhost:9530/
2. è¾“å…¥ï¼š`admin` / `admin123`
3. ç‚¹å‡»ç™»å½•

**é¢„æœŸç»“æœ**ï¼š
- âœ… ç™»å½•æˆåŠŸ
- âœ… æ˜¾ç¤ºé€šçŸ¥ï¼š"ç™»å½•æˆåŠŸï¼Œæ¬¢è¿å›æ¥ï¼"
- âœ… Token å­˜å‚¨åˆ° localStorage
- âœ… è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ

### 3. æ£€æŸ¥ localStorage
æ‰“å¼€ DevTools â†’ Application â†’ Local Storage â†’ http://localhost:9530

åº”è¯¥èƒ½çœ‹åˆ°ï¼š
- âœ… `SOY_token`: "eyJhbGci..."
- âœ… `SOY_refreshToken`: "eyJhbGci..."

## ğŸ¯ å…¶ä»–æµ‹è¯•è´¦å·

### ç®¡ç†å‘˜è´¦å·
```
ç”¨æˆ·å: admin
å¯†ç : admin123
```

### æ™®é€šç”¨æˆ·è´¦å·
```
ç”¨æˆ·å: user001
å¯†ç : pass123
```

## ğŸ“ ç›¸å…³ä¿®æ”¹æ–‡ä»¶

1. **src/service/api/auth.ts** - æ·»åŠ å­—æ®µåè½¬æ¢
2. **ç™»å½•é—®é¢˜ä¿®å¤è®°å½•.md** - é—®é¢˜æ’æŸ¥è®°å½•
3. **å­—æ®µåä¿®å¤è¯´æ˜.md** - æœ¬æ–‡æ¡£

## âš ï¸ æ³¨æ„äº‹é¡¹

### ä¸ºä»€ä¹ˆä¸ç›´æ¥ä¿®æ”¹å‰ç«¯ç»„ä»¶ï¼Ÿ

å‰ç«¯ç»„ä»¶ä½¿ç”¨ `userName` æ˜¯ Soybean Admin çš„è§„èŒƒï¼š
- å‰ç«¯ä»£ç è§„èŒƒä½¿ç”¨ camelCaseï¼ˆé©¼å³°å‘½åï¼‰
- åç«¯ JSON é€šå¸¸ä½¿ç”¨ snake_case æˆ–å…¨å°å†™
- åœ¨ API å±‚åšè½¬æ¢æ˜¯æœ€ä½³å®è·µï¼Œä¸ç ´åç»„ä»¶è§„èŒƒ

### ç±»ä¼¼é—®é¢˜æ’æŸ¥

å¦‚æœå…¶ä»– API ä¹Ÿå‡ºç°å­—æ®µåä¸åŒ¹é…ï¼š

1. **æ£€æŸ¥å‰ç«¯ç±»å‹å®šä¹‰**ï¼ˆ`src/typings/api/*.d.ts`ï¼‰
2. **æ£€æŸ¥è¯·æ±‚æ•°æ®**ï¼ˆæµè§ˆå™¨ Network é¢æ¿ï¼‰
3. **æ£€æŸ¥åç«¯ struct tag**ï¼ˆGo ä»£ç çš„ `json:"xxx"`ï¼‰
4. **åœ¨ API å±‚æ·»åŠ å­—æ®µæ˜ å°„**

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

1. **ç»Ÿä¸€å‘½åè§„èŒƒ**
   - å‰ç«¯ç»Ÿä¸€ä½¿ç”¨ camelCase
   - åç«¯ç»Ÿä¸€ä½¿ç”¨ snake_case
   - API å±‚åšè‡ªåŠ¨è½¬æ¢

2. **æ·»åŠ ç±»å‹æ£€æŸ¥**
   - ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
   - æ·»åŠ è¯·æ±‚å‚æ•°æ ¡éªŒ
   - ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶

3. **API æ–‡æ¡£åŒæ­¥**
   - ä¿æŒ Swagger æ–‡æ¡£æœ€æ–°
   - å‰åç«¯å…±äº«ç±»å‹å®šä¹‰
   - ä½¿ç”¨å·¥å…·è‡ªåŠ¨ç”Ÿæˆ API å®¢æˆ·ç«¯

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-12-11  
**çŠ¶æ€**: âœ… é—®é¢˜å·²è§£å†³ï¼Œç™»å½•åŠŸèƒ½æ­£å¸¸
